# XMTP HPKE Instrumentation Notes

## Happy-path receive with local libxmtp instrumentation

Receiver running with `./add-instrumentation.sh` + `./run.sh --recv`, using vendored `libxmtp` HPKE instrumentation. Successful delivery with HPKE unwrap logging:

```text
ðŸ’“ [2025-11-22T13:03:32.207Z] Waiting for messages... (RSS: 334MB)
ðŸ’“ [2025-11-22T13:03:37.213Z] Waiting for messages... (RSS: 334MB)
ðŸ’“ [2025-11-22T13:03:42.217Z] Waiting for messages... (RSS: 291MB)
ðŸ’“ [2025-11-22T13:03:47.222Z] Waiting for messages... (RSS: 291MB)
{"timestamp":"2025-11-22T13:03:48.572855Z","level":"ERROR","message":"HPKE unwrap_welcome starting","wrapped_welcome_len":3941,"wrapped_welcome_metadata_len":21,"private_key_len":32,"wrapper_algorithm":"XWingMLKEM768Draft6","target":"xmtp_mls::groups::mls_ext::welcome_wrapper"}
ðŸ“© Receiver got message: heyoooo
ðŸ’“ [2025-11-22T13:03:52.223Z] Waiting for messages... (RSS: 385MB)
ðŸ’“ [2025-11-22T13:03:57.228Z] Waiting for messages... (RSS: 385MB)
```

## Sad-path receive (HPKE decryption failure, error swallowed)

Receiver running with instrumentation and a sender with stale keys. HPKE unwrap fails; bindings swallow the error and continue:

```text
ðŸ’“ [2025-11-22T13:26:06.405Z] Waiting for messages... (RSS: 320MB)
ðŸ’“ [2025-11-22T13:26:11.410Z] Waiting for messages... (RSS: 317MB)
{"timestamp":"2025-11-22T13:26:14.031801Z","level":"ERROR","message":"failed to create group from welcome=[sid(110837924):oid(11)] created at 1763817973: OpenMLS HPKE error: Decryption failed.","target":"xmtp_mls::groups::welcome_sync"}
{"timestamp":"2025-11-22T13:26:14.031847Z","level":"WARN","message":"[received] message error, swallowing to continue stream","inbox_id":"9b0adb484dbb75d3c1d696a9acfd683c58dbd81e46d591eeb45f86e81de9cbff","error":"Group(UnwrapWelcome(Hpke(DecryptionFailed)))","target":"bindings_node::conversations"}
ðŸ’“ [2025-11-22T13:26:16.416Z] Waiting for messages... (RSS: 317MB)
ðŸ’“ [2025-11-22T13:26:21.420Z] Waiting for messages... (RSS: 317MB)
```

Another sad-path run (still no HPKE unwrap instrumentation visible in logs):

```text
ðŸ’“ [2025-11-22T13:54:58.754Z] Waiting for messages... (RSS: 340MB)
ðŸ’“ [2025-11-22T13:55:03.760Z] Waiting for messages... (RSS: 340MB)
{"timestamp":"2025-11-22T13:55:03.813251Z","level":"ERROR","message":"failed to create group from welcome=[sid(110838630):oid(11)] created at 1763819703: OpenMLS HPKE error: Decryption failed.","target":"xmtp_mls::groups::welcome_sync"}
{"timestamp":"2025-11-22T13:55:03.813294Z","level":"WARN","message":"[received] message error, swallowing to continue stream","inbox_id":"bd19598b2fe45d2a0f1b4d0992809ac9b3f4a622b307e94ed4fad253f544cb9d","error":"Group(UnwrapWelcome(Hpke(DecryptionFailed)))","target":"bindings_node::conversations"}
ðŸ’“ [2025-11-22T13:55:08.765Z] Waiting for messages... (RSS: 338MB)
ðŸ’“ [2025-11-22T13:55:13.771Z] Waiting for messages... (RSS: 338MB)
```

## Instrumented v2: full HPKE inputs (happy vs sad)

### Happy-path (decrypt succeeded)

```text
{"timestamp":"2025-11-22T14:27:56.291366Z","level":"ERROR","message":"HPKE unwrap_welcome starting (instrumented v2)","wrapped_welcome_len":3941,"wrapped_welcome_metadata_len":21,"private_key_len":32,"wrapped_welcome_hex":"44605d4f437d565c6078bf26f426c47e72bb96306549b41c573e0019600c1f80f4f7c75985e2a01ab631eb32267a43826b0d87b4ea19969c570af0b7f4112b32d037aca168adbe6c44e39f56570c6c5727e134ddac402eb9d816d22f43dba7ef8cb922749ffb127cdd9c72cd34df4822797ade120417d36d397aa9e7374a80b2ed48a4edd143feb40b4cd97462c02234aa25b3a66a12735161c1223cbecd659ff4e032d86e309b7e8acf96e090d9814ebc6730c8287359aaafc8d953e444e002084dfdb60625485c9685175c9d4925cde6467ecd63e1069c0a333482bf79092c3b6bc5608b1de343073c56b9b7e6cec8e5c8391c928810fd2cdc1c79500059eaa298a46c6d62c0299748ce6ce522b3cefcc357486760658c726212eda234efabeff20745cc2473d60cbdecd1374982770126be41a00b53dd624c77d766dfc887ecac6ad51bfbce16568c2f84a6b75421adeed0212eee97cab707251e30a266d01d4ad5f44aff6b81aca196159b0fb63e67cfb7354bdbfab758e5fdff6427d05fccb8d98da187fd13849e65848b992255edcd12454d5dc5166887f1bd959d9a05af5c9d74266f05c177a609c4da5d3e7fbd3d3a2874e2304722c61072cd6596177f9376f0b9ed20c99672d81a2baa1b5ce639519fd015282954dcc4d138ca83ca6a25247e34983e9669feb31ebb033fd15f6b2f55ec63286db60b02087a91f83a5a6aca377f0a41d8b643b0bf8f51ee454ee3bedb0ca223db03b40857f9f2b7b94c369ec6eef64c533d2a23eec58ac7951390d80df87f25d2271ab4058b05662eccde3e8c05068449a5615999548cde81c389ce9a7ac9107b18233e533ed3b02ea1482f52da11e485804f2257afb8ae8c1dfd68af6ca9f9c4a4cd518208177d3902add3df6a14001d012b1be99038e210bf31883f1ad25b25aa699e4c0bcd9fb190f6ffec34d27b1d424ecacf3df1ad7100f081e3b967eef1029776377258d77197debb31d4f013df98f746a4444c7234bd79ff1884e300b678b8d5c96e4861a3ea342d0bb083fbdc5cb24e3b9f5fe05cd65298fe6f862358af163a41b8f42072ed089aff0013608772a248d03a06fd04e0425953972f3f54342fb75ec7bf4b8596bd7d54504a679fd6b5b4da9866d34ad33302a71525cc94d0db7dcf6b0ea8d8355ceb33afd55bea451cd5c26457a9116098fd86434d8b1d7f1414adaa1b61443419fda01cb3e71e54ec1405522dd7ea1057aa634726fd753235b9eee5b29e3c28dbfe2e8d95aeed38df4677a4a96fbec96d3ae14412b0c96111e4711a4fec7c4268547d376102da706c9c23458ca4f07297d1ce2329ac09d0d233b41b99d8e9837ae95740f3c140d6d55e64ae6ea878ca6a90489471a1052785edf1f87474907914d8c372dbb7fab6bc7dc61d570bf474f8cb8d41a9b42339ee353a1273a0efcedb60c6e8fc44434a8769b81227f489207257b0918b275bb8e795719bb5f7039b7d92c98b97fb7766cba053f37015cc171378d93d883c05376da1d3f1c3c8f2bf7721003cab04f0f3b53f00d6a2859cba8328b4969fc42cda2a955311138040a02b4b013dde12f42727cd4695216a7d8c1336f31dd492c53a0efba453f02b9d3696228d258a4368cd320a36cf79aeca114f2bb0b6048057770867168c30e8ba35802e8f37a4568e83742319815079d6822b59de1d8b2ef0a953e2e4902264ebb9ebf7771badd9cebd60573ffbfe8d711a61983f56b9bc1198e7f0eed5c7701949b3e1fce5f23c33befccff4234d6af37418ae147c2a66f8eba090b6b3eacaf76a713aaac38b36f26c048fbd369d93ae149c864205e31821d077f92b2ccff727488d1e68b9f84323de6eee65b26ab2fd3c37c48a92dd82a60c81305f7ca85bbdaa06c374eb412b689f4b51914c99ebf36b1e24b1a467b4d99fbaf9fbb6d42fe0ad6a9dac09eccf8de5c26652ebbbe442adbf5e335a4a62613353e1930fff3c963ba3fa1818aefac38d27cb365439454fc50439447e12a90dab391374b7bae2c007d7f870e9f2e70a140e1854deb8a2c4248445c0beb3699bb600bde89c9e30b08ecf54d0c4258cb72e4510a762ec66e5503a829d1e0fc9dfba13a8ee6c4f74a33b47cd9105b2df77b91c28bcdd105b612790a9d7f93f784d1db44647218372436154d1ef1a4ca96b2dd2f3a9a47fb16457342f9d5d21cb815f9b889928e0c1c261a1700a9c7d9aa35cb730a69ab367e27a2dc6abc600d2f1c1c99119a532a513705d12ff7ca7daae0c5077f4ea4441014b11c4b35c9093965885fb540e91981a949aeb3ea678c626db0ac18e3ad52caf2dcb23c7e9763c205ba3617b9a92fc9f8cca07d2a0a3c7b292a460d9920b4881fe48156cc1dc56c822cd951a55d9ac896f5332ad8ed819bc931c4db320bfd55f35014949b94f95363c429d5a08b84ebc0176427679adc94b5e30ca8abfe1d7e8173219a04b5622813a93cf24c02e6a10cc476121ba3bb15a35ccb39faf0fc8188f53c2e44a8c3c3c59d77ff36d094f2c34d032e6013f21f9617ddc7d56d4bf26aaed666f3d74a722e296b7a70b8db77af0cd231338258b21446b3a903d50e2803466dffa1c9bd5fc6b3cf9c1f852c7e7983b8c5b1be9e05da029a0812a10fafe2ecdc84d4b2da8b0067e217d32052d5c989e9050c83994456c5d2f6a06c090ee744a7d9aad716b4d70920730cabf8c72184b2fbc6c3fd6a1d4d9472f0b36ebfc3717a62531b6b4b7a81db9fc2b66e0c618fe45c400bad407b728c7c2cf37941161eb29e1085f2721530d221e01c2fecfcb382ad7cbcfb78e3eaa61b222c69b3ec6de18d6497772ec7c52d6c7986ed39670734be4705f732f9d567df4c458677d8cacb83b03f34c1860a67c4759bea147e8c1cc67aaff16de510adb2bbd06ae1afd3fe6dab3673c1513fc9731bc309ab570e1c2898a1e80e18306b978ee39620074207232297ac4a510d8c13e6b8ee0113dbc942d80eaac50537c1777e9aea078d16ad670d34505966635927ab39443ae179b2f714a77d70a52f48ead7f9b4adc4d8da309081b0f205a685ad9edc569debb319b479c46eb94e361c13d64dc7f9f2925c7e5a30876a43870e540d42f4ad16d194d9ef495a61c513a1e7c8201ece26bd3906221e22a5bd1b8d36af2ec2659ad7a9571a49795d14430cfee0feffb2f25bd4cc77d89e8aedd21ac7fa6f4d83bdd3d962deb7bc069384fac2f070a100309c0b138db2cfdeea0ddbba290d19ac253cf4ae8425a3631e6f5e9fd82a36780c9d7530d0bfc6545c8f8ee7227c0fbfdae4b191f334578ae47162651d93be25a5d1b7da7f458fc5a4f22074bff10dd8f7b265761aa7a080bdce5b0570c6bbf7170a47f7c6223441a7189a10ff8c8ac0d7a54d2e7326448648f27ff6bcd010a2883d6027132ee22e0ffad4a6f3d17c866e118b6b8c88ff1c986de32582bfca29d5dda22922879e6c2961203d0e7dc38aa8fede833ba29b2e0aa3a2c23acbc7616a8a2fe36502a2cf7b374a04d4ae6032b1cd0cc4c213562da65a000da88f8cdee7cf086060ad5e7bf958196fbb4f263cc96124dadc9becc853e29f322259799386ce7f01a6a89f004a48de07787bbd0a459228cf2a1ef9125f11971b019d3858d3ee46a3c18ad132eba4d3646e3b47bfc6f526e7dc1dc35ac3ec3c87991342d91561765821a42fe1d961ae061bf5520995dfbb3c232d2786f4426f16abc7b706e90613242e031d6fe952b139a58cbecedb89f080ee8f8508daec17be5d5c6a8efa8d80662d7f10e0193b1ea2de6a30e396b3084253c347c7a2ec1b56f0696bcc8a7f6359212b284f3ab51be35b7ca23cca12e90c38e7dcf89d052430649baf2f9082b04522c38691ef6ca623af1a9abeb715714242b1332c6d9c3a66b760af2d3d2bf66b85a6bea28caa04e3a15ff28a49e0c58e89bde382a40c31c48dfcb9feea51d33483e4b185f0b9a11332c96a6cf6142d00418e144672c982bf56a6f269730dcee376f806ab5f68be76ea2e1332121d3ea96776fd39df1373f79856dc394b3578e7e2fa3a1e1230689737e7651156f1811549b5fa55c837ded7bab35db3e27e48c4ff2eecc48a65c9a52fc78cbab9af94a67464f553e932c6e07be141e87c3f3d2559202a0d3040c6913ec53d0b282a8d9160646e3889a861b804480d0e03d68cb6c7e2e9612c4fa9aa2a68ed975df42c18815cb93f16aba85662c7c484cdfd9aeabbb1c576210d231ecbb4e702d55826f6993a42032abb5c39e1c63b99f5b04542d4993772f03d52efd5a95660acd751d87a98f17d4362af8a7c1d6d36d18ab820fe8cf5d4e9d547280897ac6770857b5d25b73513be88e40853e2a3b2ee347d8119424adff96972a62fe5b24bbe675187e28fd3b7e6fd6ca5048b1a4627c78daf48324095a4f1d089bdf80fc6b4d2793dcd87ae25a764595899907abc38c77c9086aa19178b25ab32de612cb60fe1e8bb4c05525e4395787b0e2e6ca0341dae2eb1295ed40cc8d115225639d649c0831f54b9317b0ff98b35118b8f26f5fa2cc3f4d8b54b0dfe2fd0c8018cb326ead19aa56f18cdcf49e9b589ba2ff7caf2bc60e930a41987271179ee9044db5ed970c3c59977810d014cda1c937fd789755f50cd697084c85353b0d0a567a398c47ca1e2249ea1870e0e26b501b6e0ccb572b2fc55580bb755ad325edb35c897d4ce7442538c6da093605c23301f9c1675757420655a267d15cb88cc145c23b49408f8086cd6bbe85a038b28e07fc143839d428da2364f04a06984ee5e3db945a36bfdeadf32d0326946408f7ea7e3517d9d6cd1274cc56122c0536d8758e48b6406500cc32f62af474df0918708f6f84292d5c0f15a8cbc45d7c8d270e94e1dbd5903f5a1c9bf3eb553faf9bfcd5b94dfdc2008c70432537701ad7e4ea02fec800afbe301e0ee877e41b5bd32475c5a1849ef7c47b632354bfe37825d97f20a0a06c279e1b2348625292dd07a48d712028aa72d99a6bd35b2ab83436af1356168bc4309ab1585fe58ffb0424373d0422bf6f6b67acb7d7dfcb674cfb8377ec20a3c3fa90b972ba4e549e9069d0179d2701c5df26f1448928b31d71af8f3012a11bbcfd2fdda54a05a464d22d21b5668033951374f9844d1f2434d3921ca66c3fac6afe612f72812dcb5fa4c2a4ba07688ae37e25097493fb68ff73f0a32770170b53c1a78875e188b9f214ddd5b22253bd467bfbf63edf3ff94152d881709a82e7e80ac93dadd3aa9b70acb08c990893b3cac0068ac18f223fcf02cf065a8b03b933d585a1711c8476e2a89035266663f3f39402f287576d6fc0474825ca4c7ab30cadf14a6005640e8d47aebed78b0c79c9a5597e8c009a74e8370d94d6940d98d8ae77ceb7442e978e616903c9acdb86cf916701b76c84fb851e45a47cf2603c790146efd5d8d9dd780111e02f1b9b87a7911d4b535bd8922f5d3deecca4f5da4f79bd26bde9d8f9d586bfaf481389008329014d07d23e61b188dc42aff7751e8545e9df47d0bcf68e65a4f3f1d7b82c399aafa26950a1eff75ad6751175e201a1aac2","wrapped_welcome_metadata_hex":"1fb2099099ce5c6d43bfc2c85b748ce7e3cf163aaa","private_key_prefix_hex":"bbbab9deb2659e9ee2a0fe48220093bc","wrapper_algorithm":"XWingMLKEM768Draft6","target":"xmtp_mls::groups::mls_ext::welcome_wrapper"}
```

### Sad-path (decrypt failed)

```text
{"timestamp":"2025-11-22T14:22:10.777629Z","level":"ERROR","message":"HPKE unwrap_welcome starting (instrumented v2)","wrapped_welcome_len":3941,"wrapped_welcome_metadata_len":21,"private_key_len":32,"wrapped_welcome_hex":"4460632295710371eb2e5a6d30a6fd7df329ba30562489e472ab45fb676d801c2db19551430570d073eb9267b0e8431d93b3b0a638f74b7d7de7d1a47bca2af9f7e83598085b6fb0f0ca7325781c4b1f36cfa89dcf6876187f4be28d71707eb2194ee60582e4c520a735329a7622353bea85334b07b7f96ba2867d7a4e5aca2329e4525700811050a7fade20ff287f80a0ffd69ceb97820b5ffa8e5536e4b1a6723ae5ec15dd32b487a21f37d1c427ef8a7d76dcb5705adf528cd094c1869378b91843ca4d89f13962b43c1753b9dfce25b69e0da718a484ae560889bace00e7dd33626d6d391ccc63d9caaae7e84d318edeff2e3c3f2d59f9c0a8edaf30da7a0a85bcad385f64c1a2c6e1e1acd7a4ec2949a8734f95cdcb4a79891c683c84bfaf6dbbffe39288b13b1404619f8f217e9513b1fe0ab51a2f21db128d1ed87846d7b26fc17500005d42d870bd35448bbe627def2c6d9c9cd96957a61c0018cff88c4cd2371e4f77ce1c74ffb3950659f1a1276081622277781dbe6a0bca3aa03744cee49bd37e25a2b5a0c8b459a8f7039848e67ff58467ce68515bb242f067b995b93d81c50c2609b52d8242695613c2557b33b4a54ed432a9cb706f45a09e0ce323f8793cce204f668500262f4603280dcabbd9afeb9fad94ace0292af6631423477dd63adb15c235ab1ad9ee7ef28f3d815db0580f81de4e5c150148e4bf745450528085a20dc0dd9a8bbfbb2c43905dea05552105147a867885f77e94345efff96178f76e78e59141b4a27c986b1d0d771cce9451c5902430be60bc729488ae2f9b3d0d20f985f6af28159354f5ae0542275ee069e9f230111150507b97b6d2703bc4292081b17279a817a0213c8ee47d40d83e3f6f233269930b95487464fc7de327451a26d83c2ceab70aca6c1ca600b8bb3b93676520af4aec650ae3b48590ee2d637db075727e47e1a0a644fd849e1f87a072aae1f341480e3e8f0389ff73a449c0136fa073c7792d9010ea6b5c3bc10c6007db13166483b5ed2bcd839ab8c529ebc67cf2641a7c5b0071c3a6e0d86745d12755da9cffd07acd39cef6fcdce1023e4c5b07b1e1886ec0b526a85e5c6b08a7f596f3fe9a3133c85deda93c9620b1226efecdb910c9fcf7ac903801696019f670022981d40e54b5ca844b05d11d6ff9acc53c127f99f0220ab5fdd4ae4ae2ba3544fbef14376066b5be3009b2f67c6786cb83f8eb790059749577298f67be5751535e5029f15b83a7f8b7f0d188f65664a87df44d8516f6c3e77e076ed553b267fc663288cf523241aaea04be33308a52920f4903d19b3793ddc06d2c40b9879ca5f4535a9dd5ecfd391c4b3c1c83047c8ff175e98c8111ef24a6e1631725f3b224f08dcf9984cbaa3d308a18d451007b546eee9c751b49d5858cd1072c7f0679fa170f8e62551db00d1a7b996641251862f78bc933360add62df1a846d05a24592e14035763384e2eebefceb70f98ce31e30a32931c028a984caab4be5b93517fa145625cc4521978a25fc1c91b2d8995b9c50c32df2b6a6dc20f3e2522e98af4d02da99888b5e271d7dc1334b01734ed3574ef90008b3d366b9dd44c76eac893b4e23684cfdb1debcf7c20d05e187f6c53c2c4c6e11f981bdc7416bc739031e9c133ed617f42a8baf6346df2c59d3ff8ae100c4531320c558c4e75c28eb78ddd276cb07aefc6e85a1a820e97afb916d602ba47833ded480be8f708eae67ff0f7297d99fce4b240fb419556ef902ac8e9b56d29b06c2cb6739f3eb4517c575eb629fd6fbd877ead7ef6b9c6f45a98d0397fc4e82f874e35c20471a6d5b665bdc8daa4c4e6a60b079de00a7373c3acbbf5f63911986b4cdfe463478f7fac2ec9db9ec57690ce82ec44ede1dec2fd94dfc770adf09cedf1e80b63d26b468cd0e940591cb8bd89cd23280d36ff4e7256f9cd7ef023b60917ca06da2fbf6a2f650a8c1f16e281ff994223e366b820393a84b2328ecbab3dba3c19b277a0305377aadd2701fb68011225ecc4250478b0746ee05e278f36b23d951a7d7a692764a5e4e571aafd0d8674c87ce9100ab89d3a267e8d3c1c79b07d3928fb4a7b50fe63508e6750b6f5ec82e4f716a36e0052c1b38d98bbf72f7d297c1fe099440db24b1f497425de992615a619eef643514882312632ccd55b987758ad106d8b64fd5b91a7d6f856b0415e68938f431daed3a01db657b4bb82ad3aaac05abcb01938a19170f2c430d3dd2bbd746c32fe81db3a54d9cb14ebe6fceed55636c745de7ca023130882b9ed9df937dabefeabc54c1ae6af1c35bd9524c5a7b15c158eb5b5a7efae8d3e56b8ce6a172bb513beca519647f2968074fa689d242df90dff01fc7ad65e2d296180ce7fb91ea3b420ed98293b111ac5549aee173391bd0eb445a3090814b7bbbd11beeef450e52d61e3142d555e53fc3859b949e6f47dcceff0233e8fd541e0283dca9e54f51f4ed2ae90346820b885139e429a3a6fc89162ddf815eafd7e37859b954bf5e89b5fb874d8dfa57829d84ad2ca96e08ede2d59556060941f7e126b8134585b1306a2162fed915470c48ca65135afd50af924acb5a35a9a89f98b2d1e41f133bfd8023309112d053fdfac83bb0862d98389e4b565166877bfbc068957d5af83ce354364ee395e8930d723f3060e586ba5154da619f38285101e0b817906d5e0697532188b86c44ee53fa1c20302cc2b0fb91c4d9ad183b292202436688687ccb377c767cb688754a76880a4b6b6d4daf40b79e485d47f44dae9682c827663fb5b0c90eabb598b87a22c5aa63a54b6ba6ae727f0d850af8cb53f12300922b0432d9ac873221a99cacf14e31e0dd2e868ad061d136a708849c424b7ce38e1c1da75aaa53507b929f6c5634175975455d90414d9a06f956e71423bf4c0422d9217cd96e99e88f2762c8dcbee86592bc03240d9532b182b4b794cdcd4cc1e2464f5e963ab96adb1de6db8e4373a9f143eb1548e007c379acc34622d72e81201270063008134e1c051165ba6f44d7a82e32b9ef2b450f1a804a6611df78fdf2039feb14440c1e5952903b9e50937ae4553a59ca4a12fe8b21ea9639c56cf7b0ea27b98f14081d8d2630b926a12e19927b33e0544d5a1821e3d52f23692f9d131a24235b17ae4cb6f603e06b07e4c1def680776bb9f503226295331af4447e7a0ff7f2142594256cb7f2841d9121fcb5e8ac3cc6fd6c70e3f82d3adfe8cc67e84f8827174083c214732f0b6814d25cea3f8e52d235c34432c510e68e7097475751bc3a8d0e54527aac474ef05b41456ed9beb7e158c45ccf0fd594c64418c2220cfb1724e9da9693512466984a13506a0ad9d26bd27c0c7f22a7d0572ea79a21d905fa3e9bfc894a0011c547a6680411af46343dafc2eaf03a5383d10bba0eecfed675fb130a7cf8b7e88bcf033f5d58bea333697c5d7d47c249a54ee10df2db0f31386beef87d8633725cd59e441daeb8b10d0bed2be82cb4e6af1c97c26edd934dab561979e39d58ed49526237e5537629541bc19d9b89e60378bf84c2fc16fc69ce90510c2f0e9e148c2fd3a91fa88d6d5ddcde080af7a0f96b352668a26377b46358cf754b4a48d19cc827038a65e6732db0f4d5f64dbe4a8565f0a1a4e893dce67ea70517b82ad31e1c6d22608ac9b52e2c1b514bf4552e4257980010d3aa1a711fb9af9f919b576afb25a1a36dfa5fb75a419f51f6c7efa225e48f8ec5068e9c3f175981098fdcd07b5e279c9527cf5d2a66c035d7e677bcaa26802e3cfe6285cd371824468ce5aec4bdd99229d24b81f65111e83b4e414067575daced48e970e20369f24ceada53ee881ff23f3be5e408782f472ab491d55f3608e2bcbcabd01cb3a4900d2e69c6c9bdfc149c22bbdacdef10a7ea0923d3c8f5f2b3e574c3259e268a7f2148cc6fd32e952a1fd8eab4ac1c9d48be53930d208ba1ce0ff1d3f3b26ee6f2a5e9cf5e9832fc7145425f05b917cfc5e93822339de6b5b1bf76bacccc1ea67fcd67f6eabd5df9cbe981ccc3f3c35d5bd9d3666c2058ca93909470a6ba4c0b3a85cad37ab9ac4167701fbb4977f861d5abf03c975dc72c596848488685575390ebb96d2e0bfd0a325661c70fd471a1ee2750c110aca39e578a0b8055f57838da5dd5b1f5a0286367dcd0b754ad21dbf8d53bd49e6e2f0ef2ebe0bbea273e44cf2032cd6805abce2e7343d55a2dd12a7ed838880a1cfc7a64492ed3888c31777a14ae125e261c279b4fa63d081465525d06e7dd281de04823d5386c6c0e0a631fd3e268b53af9722e79dfbb50a7a92192e5a85ae82d7ab43ed46e58948a94162e6c536a63c1b0fe0d356c68e6ff1dc1d4ad2a7b11e24fb9d8671961b444a936ff91c2e860e8d154fe65097ae3dc808504118a9c1d46c93085db895b57c2cae5c36f15210c7d095c09df99d498402cbd3c2d61ad4706ef374ab7b681369679e332f449837bf22bfc6ae285ad9cd1a5f7b3ec7d622b1f2005e509790ce660be82685f6b2ec9e485d48806bc90ca6c0b8e251c7bba9ae95e5fe65cfaa8de8292aae2418ea6f045025764e05af183da6ca39975aefd157cf5d92ccabe4d4c99c23b6b5e14458b3498f082c8eced329c85eba0845a7f47f66b90319401b667bc8a62455dea8d8afdafe4bae6ec1961b49ad056f566b0ef8d3f99b9f116b7fdeaa5b6989759685836900a636ea00e5923833eda546b262b63e70ab4b157dc1bcdcc863b8165f82580941e592dd14de2263074e8c0928f9ceb8b373c04ef298fe338a2d784b5785494cf8197c4f45e5f4cc04bc7f54a8d1a8af22a266e6389cdbe5e444dd1c3cba19fa077dc2a5bbe946de8a7005f4f0b2d088baf702f94389205303b442a118d5c826409370fef492a693abab3f7c4798131cba45b685aa00c6b663ab2b76961d96584500679ac0a70d234d36e74a70efff8adbdcfd0db74f076b9e87804577fd798912d5bbb927bba4abe4304e81df3fe590ee11a5d9dccc0477302771186763d9733a0f3ecf64cc1b44fa384d64eeed00bc520f0c94117a0f1fc0a8ab80ea2753bc5db6b2579c4fbc4c5b20321c13480c7cbbd0be00d213646040ea9dd31e4949e5d7e1100a9011f41a7421c716ad6dfb0bcf65be61b77cb51cc6d73f353292e43a91aa40e59b87b72588fa0d3ded8279e7908b429d25f9816f07c85dfebd5de9be9f06084f9d10b2ca895164d0907e70f3c2b1c7000c19e911397a34c3242fe3c412cd558ec4daff9a7b7ca340b043b47f25357be9fcc4dc4ed1736d523071909cc94db38b44fdf62798aec96bd16ca131cc3e0d2c05e2dae7cf79a8b4f2848ec0895ccd0feb259797dec16ca8e13e4fefe5801a5fa4ce90f7f738d1cf14b671628ceb5582a0d0bf45d809d2f254436fe3cb70ce83daf0d93191c56c258a9cf318681ac725bc53383b6cde229c50bad82d5b097b51856cb576161fd0b2d714dec781245eb6cba0ec154a351155dceb8423afff1e1a566bdd74e750e6caa6709eec51590dcd7864ec98fd25c1c99db0384a19bca431609d84cfc467f432a9f","wrapped_welcome_metadata_hex":"fbfaf51ed10a9b4ee6b6493ed43853d2030d27dab4","private_key_prefix_hex":"da42b118624006b57c143d57d3da208c","wrapper_algorithm":"XWingMLKEM768Draft6","target":"xmtp_mls::groups::mls_ext::welcome_wrapper"}
```

### Quick comparison
- Ciphertexts and metadata differ entirely between runs (different welcome/KEM payloads).
- Private key prefixes differ (`bbbab9...` happy vs `da42b1...` sad), so the failing run is likely using a different installation/key package than the one the welcome was encrypted to.
- Algorithm is the same (`XWingMLKEM768Draft6`), lengths match (welcome 3941 bytes, metadata 21 bytes), so the failure is most likely key mismatch (stale or wrong HPKE private key for that welcome).
